@model CarambaOpen.ViewModels.WizardViewModel
@{
    ViewData["Title"] = "Caramba Open 2016";
}

<style type="text/css">
    html > body .carousel {
        width: 270px;
    }

    html > body .carousel-inner {
        width: 100%;
        height: 150px !important;
    }
</style>

<div class="col-xs-12 col-xs-offset-0">
    <div style="padding-left: 14px;">
        <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="3000">
            <ol class="carousel-indicators">
                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel" data-slide-to="1"></li>
                <li data-target="#myCarousel" data-slide-to="2"></li>
                <li data-target="#myCarousel" data-slide-to="3"></li>
            </ol>
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                    <img src="~/images/Golfbild1.jpg" alt="Golfbild 1" class="img-responsive" />
                </div>
                <div class="item">
                    <img src="~/images/Golfbild2.jpg" alt="Golfbild 2" class="img-responsive" />
                </div>
                <div class="item">
                    <img src="~/images/Golfbild3.jpg" alt="Golfbild 3" class="img-responsive" />
                </div>
                <div class="item"  @Html.AntiForgeryToken()
>
                    <img src="~/images/Golfbild4.jpg" alt="Golfbild 4" class="img-responsive" />
                </div>
            </div>
            <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Föregående</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Nästa</span>
            </a>
        </div>
    </div>
    <br />
@if (ViewData["Message"] != null)
{
    <span style="font-size: 20px; font-weight: bolder; padding-left: 40px" class="text-danger">@ViewData["Message"]</span>
}
   
    <div class="row">
        <form asp-controller="Home" asp-action="Add" method="post" role="form" class="form-horizontal" style="padding-left: 40px">
            <div class="wizard">
                <div class="step active">
                    <h3>Instruktioner For Dummies</h3>
                    <h4>Gör så här</h4>
                    <p>
                        Skriv in vikten av påståendena på respektive sida. Rankingen är 1-4 där 4 väger tyngst för dig 1 är oviktigt.
                        Samma siffra får inte skrivas in två gånger på samma steg.
                    </p>
                </div>
                <div class="step" style="display:none">
                    <h4>Vem är du?</h4>
                    <div class="form-group row">
                        <div class="md-col-12">
                            <select asp-for="SelectedUserId" asp-items="Model.Users" class="form-control col-xs-12"></select>
                            <span asp-validation-for="SelectedUserId" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="md-col-12">
                            <input asp-for="Password" placeholder="Vad fick jag nu för lösenord?" class="form-control col-xs-12" type="password"></>
                            <span asp-validation-for="Password" class="text-danger"></span>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <h4>@Model.Question1.Quest</h4>
                    <input type="hidden" asp-for="@Model.Question1.Order" />
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer1.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-9" style="padding-left: 30px;">
                                    <label asp-for="Answer1.Alt1" class="control-label">@Model.Question1.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer1.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-9" style="padding-left: 30px;">
                                    <label asp-for="Answer1.Alt2" class="control-label">@Model.Question1.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer1.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-9" style="padding-left: 30px;">
                                    <label asp-for="Answer1.Alt3" class="control-label">@Model.Question1.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer1.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-9" style="padding-left: 30px;">
                                    <label asp-for="Answer1.Alt4" class="control-label">@Model.Question1.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <input type="hidden" asp-for="@Model.Question2.Order" />
                    <h4>@Model.Question2.Quest</h4>
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer2.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer2.Alt1" class="control-label">@Model.Question2.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer2.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer2.Alt2" class="control-label">@Model.Question2.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer2.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer2.Alt3" class="control-label">@Model.Question2.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer2.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer2.Alt4" class="control-label">@Model.Question2.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <input type="hidden" asp-for="@Model.Question3.Order" />
                    <h4>@Model.Question3.Quest</h4>
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer3.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer3.Alt1" class="control-label">@Model.Question3.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer3.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer3.Alt2" class="control-label">@Model.Question3.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer3.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer3.Alt3" class="control-label">@Model.Question3.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer3.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer3.Alt4" class="control-label">@Model.Question3.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <input type="hidden" asp-for="@Model.Question4.Order" />
                    <h4>@Model.Question4.Quest</h4>
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer4.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer4.Alt1" class="control-label">@Model.Question4.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer4.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer4.Alt2" class="control-label">@Model.Question4.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer4.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer4.Alt3" class="control-label">@Model.Question4.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer4.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer4.Alt4" class="control-label">@Model.Question4.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <input type="hidden" asp-for="@Model.Question5.Order" />
                    <h4>@Model.Question5.Quest</h4>
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer5.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer5.Alt1" class="control-label">@Model.Question5.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer5.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer5.Alt2" class="control-label">@Model.Question5.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer5.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer5.Alt3" class="control-label">@Model.Question5.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer5.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer5.Alt4" class="control-label">@Model.Question5.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <input type="hidden" asp-for="@Model.Question1.Order" />
                    <h4>@Model.Question5.Quest</h4>
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer6.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer6.Alt1" class="control-label">@Model.Question6.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer6.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer6.Alt2" class="control-label">@Model.Question6.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer6.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer6.Alt3" class="control-label">@Model.Question6.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer6.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer6.Alt4" class="control-label">@Model.Question6.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="step" style="display:none">
                    <h4>@Model.Question7.Quest</h4>
                    <h5>G = golf, F = fest/mat/leva, R = resa (flyg, bil, båt), B = boende</h5>
                    <div class="form-group">
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer7.Alt1" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer7.Alt1" class="control-label">@Model.Question7.Alt1</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer7.Alt2" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer7.Alt2" class="control-label">@Model.Question7.Alt2</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer7.Alt3" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer7.Alt3" class="control-label">@Model.Question7.Alt3</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="pull-left col-xs-12">
                                <div class="col-xs-1">
                                    <input type="text" value="" style="width: 40px" asp-for="Answer7.Alt4" class="form-control pull-left ranking" />
                                </div>
                                <div class="col-xs-11" style="padding-left: 30px;">
                                    <label asp-for="Answer7.Alt4" class="control-label">@Model.Question7.Alt4</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="button" class="prev btn btn-danger text-right" style="display: none" value="Föregående" />
                <input type="button" class="next btn btn-primary text-right" value="Nästa" />
                <input type="submit" id="Finish" class="finish btn btn-success text-right" style="display: none;" disabled value="Slutför" />
            </div>
        </form>
    </div>
</div>
@section Scripts
{
    <script type="text/javascript">
        $(function () {
            $('#Finish').click(function(event) {
                // Check if all values has been filled
                var inputs = $(this).parent().find(".step.active input");
                if (inputs === undefined || inputs === null) {
                    return;
                }

                var empty = inputs.filter(function () {
                    return this.value === "";
                });
                if (empty.length) {
                    alert("Du måste fylla i ALLT. Fattade du inte det? På riktigt? Hur korkad är du egentligen? DET kanske borde vara en fråga här istället...");
                    event.preventDefault();
                    return;
                }
            });

            // Only allow one digit between 1-4
            $('.ranking').on('keypress', function(evt) {
                return isStepOk($(this), evt);
            });

            // Only allow one digit between 1-4
            $('.ranking').on('keypress', function (evt) {
                return isStepOk($(this), evt);
            });

            function isStepOk(currentObj, evt)
            {
                var value = currentObj.val();
                var id = currentObj.attr('id');

                var charCode = (evt.which) ? evt.which : evt.keyCode;

                // Not allowed more than 1 number and not allowed to press arrow down
                if (((value === '1' || value === '2' || value === '3' || value === '4') && (charCode >= 49 && charCode <= 52)) || charCode === 40) {
                    console.log("Trying to enter more than one digit");
                    return false;
                }

                var baseId = id.substring(0, id.length - 1);

                // Don't allow the same number on different input fields
                if (charCode >= 49 && charCode <= 52) {
                    console.log("We are trying to enter a digit...let's see if it's ok");
                    for (var i = 1; i < 5; i++) {
                        var otherId = "#" + baseId + i;
                        var currentId = "#" + id;

                        if (otherId !== currentId) {
                            var otherValue = $(otherId).val();
                            if (otherValue === evt.key) {
                                return false;
                            }
                        }
                    }
                }

                var isOk = !(charCode !== 46 && charCode > 31 && (charCode < 49 || charCode > 52));

                return isOk;
            }

            $('.ranking').on('focusout', function() {
                var value = $(this).val();

                $(this).val(value.replace(/[^1-4]{1}/g, ''));
            });
            $('.wizard .prev').click(function() {
                var wizard = $(this).parent('.wizard');

                $('.step.active', wizard).hide();

                var currentStep = $('.step.active', wizard);
                currentStep.hide();
                currentStep.removeClass('active');

                var newStep = currentStep.prev('.step', wizard);
                newStep.addClass('active');
                newStep.show();

                if ($('.step:first', wizard)[0] === newStep[0]) {
                    $(this).hide();
                }

                $('.next', wizard).show();
                $('.finish', wizard).hide();
            });

            $('.wizard .next').click(function() {
                var inputs = $(this).parent().find(".step.active input");
                if (inputs === undefined || inputs === null) {
                    return;
                }

                var userSelect = $(this).parent().find(".step.active #SelectedUserId option:selected");
                if (userSelect !== undefined && userSelect !== null) {
                    if (userSelect.val() === '0') {
                        alert("Du måste ju välja vem du är. Har du problem att lösa koden, eller?!");
                        return;
                    }
                }

                var empty = inputs.filter(function () {
                    return this.value === "";
                });
                if (empty.length) {
                    alert("Du måste fylla i ALLT. Fattade du inte det? På riktigt? Hur korkad är du egentligen? DET kanske borde vara en fråga här istället...");
                    return;
                }

                var wizard = $(this).parent('.wizard');

                $('.step.active', wizard).hide();

                var currentStep = $('.step.active', wizard);
                currentStep.hide();
                currentStep.removeClass('active');

                var newStep = currentStep.next('.step', wizard);
                newStep.addClass('active');
                newStep.show();

                if ($('.step:last', wizard)[0] === newStep[0]) {
                    $(this).hide();
                    $('.finish').show();
                    $('.finish').prop('disabled', false);
                }

                $('.prev', wizard).show();
            });
        });
    </script>
}

